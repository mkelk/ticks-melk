{
  "id": "7ab",
  "title": "Tick attachments (screenshots for content review)",
  "description": "Add support for file attachments (primarily screenshots) to ticks. Key use case: content review workflows where visual proof is required before approval.\n\n## Overview\n\nUsers can attach images to ticks via CLI. Files are uploaded to R2 via tickboard.dev worker, stored with permanent unguessable URLs. Attachments display across all interfaces (CLI, TUI, web board).\n\n## Design Decisions\n\n- **Storage**: Cloudflare R2 via tickboard.dev worker proxy\n- **Auth**: Existing ~/.tickboardrc token (TICKBOARD_TOKEN)\n- **URL format**: `https://attachments.tickboard.dev/{random24}/{filename}`\n- **Security**: Unguessable 24-char random path (no project/tick in URL)\n- **Cost**: ~$0.01/month per 1000 screenshots (negligible, free tier covers 33K+)\n\n## Data Structure\n\n```go\ntype Attachment struct {\n    ID          string    `json:\"id\"`           // 4-char internal ref (a1b2)\n    Key         string    `json:\"key\"`          // 24-char random R2 key\n    Filename    string    `json:\"filename\"`     // original filename\n    Description string    `json:\"description\"`  // optional caption\n    ContentType string    `json:\"content_type\"` // image/png, image/jpeg, etc.\n    Size        int64     `json:\"size\"`         // bytes\n    URL         string    `json:\"url\"`          // full permanent URL\n    UploadedAt  time.Time `json:\"uploaded_at\"`\n    UploadedBy  string    `json:\"uploaded_by\"`\n}\n\ntype Tick struct {\n    // ... existing fields\n    Attachments []Attachment `json:\"attachments,omitempty\"`\n}\n```\n\n## CLI Commands\n\n```bash\n# Attach file to tick\ntk attach \u003ctick-id\u003e \u003cfile\u003e [--description \"caption\"]\n\n# List attachments\ntk attachments \u003ctick-id\u003e\n\n# Remove attachment\ntk detach \u003ctick-id\u003e \u003cattachment-id\u003e\n\n# Open attachment in browser\ntk attach \u003ctick-id\u003e --open \u003cattachment-id\u003e\n```\n\n## Upload Flow\n\n```\ntk attach abc screenshot.png --description \"Login page redesign\"\n    â”‚\n    â”œâ”€ Validate: file exists, is image, \u003c10MB\n    â”œâ”€ Read token from ~/.tickboardrc\n    â”‚\n    â–¼\nPOST https://tickboard.dev/api/attachments\n  Authorization: Bearer \u003ctoken\u003e\n  Content-Type: multipart/form-data\n  Body: file, filename, content_type\n    â”‚\n    â–¼\nWorker (tickboard.dev):\n  â€¢ Validate token\n  â€¢ Generate 24-char random key\n  â€¢ Upload to R2: {key}/{filename}\n  â€¢ Return: {key, url, size, content_type}\n    â”‚\n    â–¼\nCLI:\n  â€¢ Generate 4-char attachment ID\n  â€¢ Update .tick/issues/abc.json with attachment\n  â€¢ Output: \"Attached a1b2: screenshot.png (245KB)\"\n```\n\n## Display Integration\n\n### tk show\n```\nâ•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®\nâ”‚ abc  P2  task  â—  @alice                                    â”‚\nâ”‚                                                             â”‚\nâ”‚ Review login page redesign                                  â”‚\nâ”‚                                                             â”‚\nâ”‚ Description:                                                â”‚\nâ”‚   Please review the new login page design.                  â”‚\nâ”‚                                                             â”‚\nâ”‚ Attachments:                                                â”‚\nâ”‚   ğŸ“ a1b2  Login page redesign (login.png, 245KB)          â”‚\nâ”‚   ğŸ“ c3d4  Error state (error.png, 89KB)                   â”‚\nâ”‚                                                             â”‚\nâ”‚ Created: 2024-01-15 10:30 by alice                          â”‚\nâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯\n```\n\n### tk view (TUI)\n- Show attachments section in right pane detail view\n- Keybinding to open attachment in browser (e.g., 'o' on selected attachment)\n\n### tk board (web)\n- Attachment count badge on cards: ğŸ“ 2\n- Detail drawer: thumbnail grid with lightbox viewer\n- Click thumbnail to open full-size in modal\n\n### tk list\n- Optional: show ğŸ“ indicator for ticks with attachments\n\n## Validation Rules\n\n- Max file size: 10MB\n- Allowed types: image/png, image/jpeg, image/gif, image/webp\n- Max attachments per tick: 10\n- Filename sanitization: alphanumeric, dash, underscore, dot only\n\n## Error Handling\n\n- No token configured: \"Error: tickboard.dev authentication required. Run 'tk auth' or set TICKBOARD_TOKEN\"\n- Upload failed: Retry with backoff, clear error message\n- File too large: \"Error: file exceeds 10MB limit\"\n- Invalid type: \"Error: only images allowed (png, jpg, gif, webp)\"\n\n## Future Considerations (not in scope)\n\n- Video attachments\n- Paste from clipboard\n- Drag-drop in tk board\n- Attachment comments/annotations\n- Automatic screenshot capture",
  "status": "open",
  "priority": 1,
  "type": "epic",
  "owner": "peter@engelbrecht.dk",
  "labels": [
    "feature",
    "content-review"
  ],
  "created_by": "peter@engelbrecht.dk",
  "created_at": "2026-01-21T16:21:26.848557Z",
  "updated_at": "2026-01-21T16:21:26.848557Z"
}