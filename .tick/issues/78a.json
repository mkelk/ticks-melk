{
  "id": "78a",
  "title": "Implement tickboard.dev /api/attachments upload endpoint",
  "description": "Add Worker endpoint for attachment uploads to tickboard.dev.\n\n## Endpoint\n\nPOST /api/attachments\n- Auth: Bearer token (existing tickboard token)\n- Content-Type: multipart/form-data\n- Body: file (binary), filename (string), content_type (string)\n\n## Worker Logic\n\n1. Validate bearer token (existing auth mechanism)\n2. Validate file:\n   - Size \u003c= 10MB\n   - Content-Type in allowed list (image/png, image/jpeg, image/gif, image/webp)\n3. Generate 24-char random key (alphanumeric, URL-safe)\n4. Upload to R2:\n   - Bucket: ticks-attachments (or similar)\n   - Key: {random24}/{sanitized_filename}\n   - Metadata: content_type, uploaded_by, uploaded_at\n5. Return JSON:\n```json\n{\n  \"key\": \"x7k2mP9qR3nL5vB8tY4wZ1aQ\",\n  \"url\": \"https://attachments.tickboard.dev/x7k2mP9qR3nL5vB8tY4wZ1aQ/screenshot.png\",\n  \"size\": 245000,\n  \"content_type\": \"image/png\"\n}\n```\n\n## R2 Setup\n\n- Create R2 bucket: ticks-attachments\n- Configure public access via custom domain: attachments.tickboard.dev\n- CORS headers for web access\n\n## Error Responses\n\n- 401: Invalid or missing token\n- 413: File too large (\u003e10MB)\n- 415: Unsupported media type\n- 500: Upload failed\n\n## Rate Limiting\n\n- Consider: 100 uploads/hour per token (prevent abuse)",
  "status": "open",
  "priority": 1,
  "type": "task",
  "owner": "peter@engelbrecht.dk",
  "parent": "7ab",
  "created_by": "peter@engelbrecht.dk",
  "created_at": "2026-01-21T16:22:15.594079Z",
  "updated_at": "2026-01-21T16:22:15.594079Z"
}