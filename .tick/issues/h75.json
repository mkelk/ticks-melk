{
  "id": "h75",
  "title": "Manual security verification and penetration testing",
  "description": "Manual verification of security fixes before deployment to production.\n\n## Pre-Deployment Checklist\n\n### 1. Code Review Verification\n\n- [ ] All ProjectRoom routes have auth checks\n- [ ] userOwnsProject function returns false on errors\n- [ ] X-Validated-User-Id header required by DO\n- [ ] Debug endpoints removed or secured\n- [ ] Token not in URLs (check network tab)\n- [ ] No console.log of tokens\n\n### 2. Local Testing\n\nUsing wrangler dev:\n\n# Start local dev server\ncd cloud/worker \u0026\u0026 wrangler dev\n\n# Test unauthorized access\ncurl -v http://localhost:8787/api/projects/any%2Fproject/state\n# Expected: 401 or 404\n\ncurl -v -X POST http://localhost:8787/api/projects/any%2Fproject/ticks/abc/approve\n# Expected: 401\n\n# Test cross-user access (need two test accounts)\ncurl -v -H 'Authorization: Bearer USER1_TOKEN' \\\n  http://localhost:8787/api/projects/user2%2Fproject/state\n# Expected: 403\n\n### 3. WebSocket Testing\n\nUsing websocat or similar:\n\n# Without token\nwebsocat ws://localhost:8787/api/projects/test/sync\n# Expected: Connection rejected\n\n# With invalid token  \nwebsocat 'ws://localhost:8787/api/projects/test/sync?token=invalid'\n# Expected: Connection rejected\n\n# With valid token, wrong project\nwebsocat 'ws://localhost:8787/api/projects/other-user%2Fproject/sync?token=MY_TOKEN'\n# Expected: Connection rejected (403)\n\n### 4. Production Smoke Test\n\nAfter deployment:\n\n# Verify own project works\n# Verify other users' projects are inaccessible\n# Check Cloudflare logs for auth failures\n# Monitor error rates\n\n## Penetration Test Scenarios\n\n### Scenario A: Direct DO Access Attempt\nTry to access DO directly (should be impossible via CF routing)\n\n### Scenario B: Header Injection\nX-Validated-User-Id: attacker\n# Verify this is overwritten by worker, not trusted from client\n\n### Scenario C: Project ID Manipulation\n/api/projects/..%2F..%2Fother-user%2Fproject/sync\n# Verify path traversal doesn't bypass auth\n\n### Scenario D: Token Reuse\nUse revoked token - should fail\n\n### Scenario E: Timing Attack\nMeasure response times for:\n- Invalid token\n- Valid token, wrong project\n- Valid token, own project\nEnsure no timing leakage\n\n## Sign-Off Required\n\n- [ ] Developer self-test passed\n- [ ] Security review of changes\n- [ ] Manual penetration testing passed\n- [ ] Production smoke test passed",
  "notes": "2026-01-24 11:44 - Agent swarm completed Waves 1-4. This task requires manual human verification and penetration testing before proceeding to deployment.",
  "status": "closed",
  "priority": 1,
  "type": "task",
  "owner": "peter@engelbrecht.dk",
  "blocked_by": [
    "1s3"
  ],
  "parent": "5jf",
  "acceptance_criteria": "All manual security tests pass, sign-off obtained",
  "created_by": "peter@engelbrecht.dk",
  "created_at": "2026-01-24T10:11:03.802538Z",
  "updated_at": "2026-01-24T11:08:36.021274Z",
  "closed_at": "2026-01-24T11:02:37.604996Z",
  "closed_reason": "Manual security verification complete. All 10 security tests passed: debug endpoints return 404, all tick operations require auth (401), WebSocket requires valid token (401), header injection blocked."
}