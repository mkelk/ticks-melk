{
  "id": "8kp",
  "title": "Update Merge() to use ParentBranch with fallback and tests",
  "description": "Update MergeManager.Merge() to merge to parent branch with fallback to main.\n\nFiles to modify:\n- internal/worktree/merge.go\n\nImplementation:\n1. Rename checkoutMain() to checkoutBranch(branch string) - update the git checkout command to use the parameter\n2. In Merge():\n   - Determine target: start with m.mainBranch as default\n   - If wt.ParentBranch != \"\" and branchExists(m.repoRoot, wt.ParentBranch), use parent as target\n   - If wt.ParentBranch != \"\" but branch doesn't exist, print warning: fmt.Printf(\"Warning: Parent branch %q not found, merging to %s\\n\", wt.ParentBranch, m.mainBranch)\n   - Call checkoutBranch(target) instead of checkoutMain()\n\nTests to write in merge_test.go:\n1. TestMergeManager_MergesToParentBranch - create worktree from feature branch, merge, verify merged to feature not main\n2. TestMergeManager_FallbackToMain - create worktree, delete parent branch, merge, verify falls back to main with warning\n\nWrite tests alongside implementation.",
  "status": "open",
  "priority": 2,
  "type": "task",
  "owner": "morten@elk.dk",
  "blocked_by": [
    "vwp"
  ],
  "parent": "rdd",
  "acceptance_criteria": "go test ./internal/worktree/... -run TestMergeManager_MergesToParentBranch -v passes; go test ./internal/worktree/... -run TestMergeManager_FallbackToMain -v passes",
  "created_by": "morten@elk.dk",
  "created_at": "2026-01-22T05:52:39.5712265Z",
  "updated_at": "2026-01-22T05:52:39.5712265Z"
}